<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>BOE-BOT.ORG</title>
    <link href="/css/Semantic-UI-CSS-master-2.2/semantic.css" rel="stylesheet" />

    <script src="/js/plugins/jquery/jquery-3.2.1.min.js"></script>
    <script src="/js/plugins/vue/vue.min.js"></script>
    <script src="/js/plugins/d3/d3.min.js"></script>
    <script src="/css/Semantic-UI-CSS-master-2.2/semantic.min.js"></script>
    <script src="/js/plugins/Lodash/lodash.js"></script>
    <script src="/js/d3_Graphics/pelotitas.js"></script>
    <link href="/css/pelotitas.css" rel="stylesheet" />
    <script src="/js/tree/_app.js"></script>
    <style>
        .hidden {
            display: none;
        }

        #search {
            width: 425px;
        }

        #panelSearch {
            position: absolute;
            top: 71px;
            left: 0px;
            margin-top: -1px;
            height: 385px;
            width: 425px;
            display: none;
            z-index: 9999;
        }

        #panelSearch .item:hover {
            background-color: lightgray;
            font-weight: bolder;
            cursor: pointer;
        }

        #panelSearch .item.selected {
            background-color: lightgray;
            font-weight: bolder;
        }

        #search.selected {
            background-color: lightgray
        }

        #borme {
            width: 425px;
        }
        #next {
            cursor: pointer
        }
        #cleaner{
            cursor: pointer
        }
    </style>
    <script>

        String.prototype.replaceAll = function (target, replacement) {
            return this.split(target).join(replacement);
        };

        $(document).ready(function () {
            App = App()
            App.Framework.PanelSearch.init(App)

            $('#cleaner').click(function () {
                if ($('g.hidden').length > 0) {
                    $('g').removeClass('hidden')
                    $('line').removeClass('hidden')
                    App.root.refresh(3)
                } else {
                    $('g circle').not('.Mark').parent().addClass('hidden')
                    $('g circle.Mark').parent().show()
                    $('line').not('.Mark').addClass('hidden')
                    App.root.refresh(1)
                }
            })
            $('#next').click(function () {

                debugger
                App.level++
                $('#stateAsk').val(($('#stateAsk').val() == 1 ? 0 : 1))

                if (App.links[App.level] == null)
                    App.links[App.level] = []

                function go(_e, _t, callback, go) {
                    $('#counterNodes').html(_e+" de "+_t).removeClass("hidden")
                    //console.log(_e,_t)
                    if (_e + $('circle.Mark').length < _t) {
                        $('#next').addClass('hidden')
                        var _n = App.links[App.level - 1][_e]
                        App.root.expandNode(_n, function (t) {
                            App.root.addRelationsToGraph(_n, t);
                            _e++
                            go(_e, _t, callback, go)
                            App.root.update()
                        })
                    } else {
                        $('#next').removeClass('hidden')
                        $('#counterNodes').html("").addClass("hidden")
                        //debugger
                        callback()
                    }

                }

                go(0, App.links[App.level - 1].length, function () {



                }, go)

                //debugger
            })



        }).click(function () {
            $('#panel').hide()
        })
    </script>
</head>
<body>
    <div class="ui segment" style="margin:10px;height:calc(100% - 20px);">
        <div class="ui one column very relaxed grid" style="width:100%;height:calc(100% - 30px);">
            <div id="Search" class="column">
                <div class="ui form">
                    <input type="hidden" id="parent" value="" />
                    <input type="hidden" id="stateAsk" value="" />
                    <div class="inline fields">
                        <div class="field">
                            <div class="ui radio checkbox checked">
                                <input type="radio" name="typeSearch" data="Empresa" checked="checked">
                                <label>Empresas</label>
                            </div>
                        </div>
                        <div class="field">
                            <div class="ui radio checkbox">
                                <input type="radio" name="typeSearch" data="Directivo">
                                <label>Directivos</label>
                            </div>
                        </div>
                    </div>
                    <div class="inline fields">
                        <div class="ui icon input">

                            <input id="search" type="text" placeholder="Buscar...">
                            <i class="inverted circular search link icon go disabled"></i>
                        </div>
                        <div id="panelSearch" class="ui segment hidden">
                            <!-- Create an instance of the list-item-search component -->
                            <div class="ui mini list">
                                <list-item-search v-for="item in SearchList"
                                                  v-bind:List="item"
                                                  v-bind:key="item._key">
                                </list-item-search>
                            </div>

                        </div>
                        <div class="field">

                            <label id="counterNodes" class="hidden"></label>
                            <a id="next" class="hidden">Siguiente</a>
                            <a id="cleaner" class="hidden">Limpiar</a>
                        </div>

                    </div>
                </div>
                
                <div id="data" class="ui segment" style="margin:10px;height:calc(100% - 40px);">
                    <a id="next" class="hidden">Siguiente</a>
                    <a id="cleaner" class="hidden">Limpiar</a>
                    <div id="graph_container">

                        <svg id="relations">
                            <title>Mapa de empresas y directivos relacionados con </title>
                            <desc>Este mapa interactivo permite visualizar las relaciones entre empresas y cargos directivos.</desc>
                            <g z-order="1000"></g>
                            <g>
                                <g id="links"></g>
                                <g id="nodes"></g>
                                <g id="nodetexts"></g>
                            </g>

                        </svg>

                        <div id="ui">
                            <div id="topleft">
                                <h1>Diagrama de relaciones</h1>

                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>

    </div>
</body>

</html>